pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	col=false
	gravity=.2
	jump_force=5
	hold_gravity=.2
	plr={
		x=30,
		y=30,
		dx=0,
		dy=0,
		f=false,
		g1x=2,
		g2x=6,
		gy=7,
		jumping=false
	}
end

function _update()
	move_player(plr)
	jump(plr)
	handle_gravity(plr)
end

function _draw()
	cls()
	map()
	spr(2,plr.x,plr.y,1,1,plr.f)
	pset(c1x,cy,8)
	pset(c2x,cy,8)
end

-->8
function move_player(p)
	p.dx=0
	if btn(⬅️) then
		p.dx=-1
		p.f=true
	elseif btn(➡️) then
		p.dx=1
		p.f=false
	end
	p.x+=p.dx
end

function jump(p)
	if btnp(❎) and onground(p) then
		p.dy=-jump_force
		p.jumping=true
		sfx(0)
	end
	
	if p.jumping and btn(❎) and p.dy<0 then
		p.dy+= hold_gravity
	else
		p.jumping=false
	end
	
end

function handle_gravity(p)
	p.dy+=gravity

	local ly=p.y
	p.y+=p.dy

	c1x=p.x+p.g1x
	c2x=p.x+p.g2x
	cy=p.y+p.gy

	if mget(c1x/8,cy/8)==4 or mget(c2x/8,cy/8)==4 then
		col=true
	else
		col=false
	end

	if col then
		p.y=ly
		p.dy=0
	end
end

function onground(p)
	return fget(mget((p.x+4)/8,(p.y+9)/8),0)
end

__gfx__
000000000000000000000000ccccccccdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000ccccccccddddd5dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000000000000000000cccccccc5dd5d5dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000000005000500ccccccccdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000000005000355ccccccccdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007000000000005555550ccccccccd5d5dddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000500050ccccccccddd5d55d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000500050ccccccccdddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000dddddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000ddddd5dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000005dd5d5dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000dddddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000dddddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d5d5dddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000ddd5d55d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000dddddddd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000001000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303040404030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303040404030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303040404030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303040404040300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00010000000000000000000000002605028050290502a0502c0502d0502d0502c0502905026050240500000000000000000000000000000000000000000000000000000000000000000000000000000000000000
